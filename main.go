package streamdeck

import (
	"bytes"
	"fmt"
	"os"
	"time"

	"github.com/disintegration/gift"
	"github.com/karalabe/hid"

	"image"
	"image/color"
	"image/draw"
	"image/jpeg" // support jpeg
)

const VendorID = 4057
const ProductID = 0x6c

func Main() {

	devices := hid.Enumerate(VendorID, ProductID)

	if len(devices) == 0 {
		panic("no stream deck device found")
	}

	id := 0
	device, err := devices[id].Open()
	if err != nil {
		panic(err)
	}

	go read(device)

	reset(device)
	//writeBlankImage(device, 9)

	/*
		raw_image := []byte{'\xff', '\xd8', '\xff', '\xe0', '\x00', '\x10', '\x4a', '\x46', '\x49', '\x46', '\x00', '\x01', '\x01', '\x00', '\x00', '\x01', '\x00', '\x01', '\x00', '\x00', '\xff', '\xdb', '\x00', '\x43', '\x00', '\x08', '\x06', '\x06', '\x07', '\x06', '\x05', '\x08', '\x07', '\x07', '\x07', '\x09', '\x09', '\x08', '\x0a', '\x0c', '\x14', '\x0d', '\x0c', '\x0b', '\x0b', '\x0c', '\x19', '\x12', '\x13', '\x0f', '\x14', '\x1d', '\x1a', '\x1f', '\x1e', '\x1d', '\x1a', '\x1c', '\x1c', '\x20', '\x24', '\x2e', '\x27', '\x20', '\x22', '\x2c', '\x23', '\x1c', '\x1c', '\x28', '\x37', '\x29', '\x2c', '\x30', '\x31', '\x34', '\x34', '\x34', '\x1f', '\x27', '\x39', '\x3d', '\x38', '\x32', '\x3c', '\x2e', '\x33', '\x34', '\x32', '\xff', '\xdb', '\x00', '\x43', '\x01', '\x09', '\x09', '\x09', '\x0c', '\x0b', '\x0c', '\x18', '\x0d', '\x0d', '\x18', '\x32', '\x21', '\x1c', '\x21', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\xff', '\xc0', '\x00', '\x11', '\x08', '\x00', '\x60', '\x00', '\x60', '\x03', '\x01', '\x22', '\x00', '\x02', '\x11', '\x01', '\x03', '\x11', '\x01', '\xff', '\xc4', '\x00', '\x1f', '\x00', '\x00', '\x01', '\x05', '\x01', '\x01', '\x01', '\x01', '\x01', '\x01', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x01', '\x02', '\x03', '\x04', '\x05', '\x06', '\x07', '\x08', '\x09', '\x0a', '\x0b', '\xff', '\xc4', '\x00', '\xb5', '\x10', '\x00', '\x02', '\x01', '\x03', '\x03', '\x02', '\x04', '\x03', '\x05', '\x05', '\x04', '\x04', '\x00', '\x00', '\x01', '\x7d', '\x01', '\x02', '\x03', '\x00', '\x04', '\x11', '\x05', '\x12', '\x21', '\x31', '\x41', '\x06', '\x13', '\x51', '\x61', '\x07', '\x22', '\x71', '\x14', '\x32', '\x81', '\x91', '\xa1', '\x08', '\x23', '\x42', '\xb1', '\xc1', '\x15', '\x52', '\xd1', '\xf0', '\x24', '\x33', '\x62', '\x72', '\x82', '\x09', '\x0a', '\x16', '\x17', '\x18', '\x19', '\x1a', '\x25', '\x26', '\x27', '\x28', '\x29', '\x2a', '\x34', '\x35', '\x36', '\x37', '\x38', '\x39', '\x3a', '\x43', '\x44', '\x45', '\x46', '\x47', '\x48', '\x49', '\x4a', '\x53', '\x54', '\x55', '\x56', '\x57', '\x58', '\x59', '\x5a', '\x63', '\x64', '\x65', '\x66', '\x67', '\x68', '\x69', '\x6a', '\x73', '\x74', '\x75', '\x76', '\x77', '\x78', '\x79', '\x7a', '\x83', '\x84', '\x85', '\x86', '\x87', '\x88', '\x89', '\x8a', '\x92', '\x93', '\x94', '\x95', '\x96', '\x97', '\x98', '\x99', '\x9a', '\xa2', '\xa3', '\xa4', '\xa5', '\xa6', '\xa7', '\xa8', '\xa9', '\xaa', '\xb2', '\xb3', '\xb4', '\xb5', '\xb6', '\xb7', '\xb8', '\xb9', '\xba', '\xc2', '\xc3', '\xc4', '\xc5', '\xc6', '\xc7', '\xc8', '\xc9', '\xca', '\xd2', '\xd3', '\xd4', '\xd5', '\xd6', '\xd7', '\xd8', '\xd9', '\xda', '\xe1', '\xe2', '\xe3', '\xe4', '\xe5', '\xe6', '\xe7', '\xe8', '\xe9', '\xea', '\xf1', '\xf2', '\xf3', '\xf4', '\xf5', '\xf6', '\xf7', '\xf8', '\xf9', '\xfa', '\xff', '\xc4', '\x00', '\x1f', '\x01', '\x00', '\x03', '\x01', '\x01', '\x01', '\x01', '\x01', '\x01', '\x01', '\x01', '\x01', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x01', '\x02', '\x03', '\x04', '\x05', '\x06', '\x07', '\x08', '\x09', '\x0a', '\x0b', '\xff', '\xc4', '\x00', '\xb5', '\x11', '\x00', '\x02', '\x01', '\x02', '\x04', '\x04', '\x03', '\x04', '\x07', '\x05', '\x04', '\x04', '\x00', '\x01', '\x02', '\x77', '\x00', '\x01', '\x02', '\x03', '\x11', '\x04', '\x05', '\x21', '\x31', '\x06', '\x12', '\x41', '\x51', '\x07', '\x61', '\x71', '\x13', '\x22', '\x32', '\x81', '\x08', '\x14', '\x42', '\x91', '\xa1', '\xb1', '\xc1', '\x09', '\x23', '\x33', '\x52', '\xf0', '\x15', '\x62', '\x72', '\xd1', '\x0a', '\x16', '\x24', '\x34', '\xe1', '\x25', '\xf1', '\x17', '\x18', '\x19', '\x1a', '\x26', '\x27', '\x28', '\x29', '\x2a', '\x35', '\x36', '\x37', '\x38', '\x39', '\x3a', '\x43', '\x44', '\x45', '\x46', '\x47', '\x48', '\x49', '\x4a', '\x53', '\x54', '\x55', '\x56', '\x57', '\x58', '\x59', '\x5a', '\x63', '\x64', '\x65', '\x66', '\x67', '\x68', '\x69', '\x6a', '\x73', '\x74', '\x75', '\x76', '\x77', '\x78', '\x79', '\x7a', '\x82', '\x83', '\x84', '\x85', '\x86', '\x87', '\x88', '\x89', '\x8a', '\x92', '\x93', '\x94', '\x95', '\x96', '\x97', '\x98', '\x99', '\x9a', '\xa2', '\xa3', '\xa4', '\xa5', '\xa6', '\xa7', '\xa8', '\xa9', '\xaa', '\xb2', '\xb3', '\xb4', '\xb5', '\xb6', '\xb7', '\xb8', '\xb9', '\xba', '\xc2', '\xc3', '\xc4', '\xc5', '\xc6', '\xc7', '\xc8', '\xc9', '\xca', '\xd2', '\xd3', '\xd4', '\xd5', '\xd6', '\xd7', '\xd8', '\xd9', '\xda', '\xe2', '\xe3', '\xe4', '\xe5', '\xe6', '\xe7', '\xe8', '\xe9', '\xea', '\xf2', '\xf3', '\xf4', '\xf5', '\xf6', '\xf7', '\xf8', '\xf9', '\xfa', '\xff', '\xda', '\x00', '\x0c', '\x03', '\x01', '\x00', '\x02', '\x11', '\x03', '\x11', '\x00', '\x3f', '\x00', '\xf9', '\xfe', '\x8a', '\xfb', '\x1d', '\x7c', '\x17', '\xe1', '\x0b', '\x74', '\x08', '\xfe', '\x1a', '\xd2', '\x18', '\xfa', '\x9d', '\x3e', '\x32', '\x7f', '\x45', '\xa8', '\xe5', '\xf0', '\x67', '\x84', '\xcc', '\x8b', '\x29', '\xf0', '\xde', '\x8c', '\x90', '\xe3', '\x03', '\xfd', '\x02', '\x30', '\x73', '\xea', '\x78', '\xa9', '\xe6', '\x1d', '\x8f', '\x8f', '\x28', '\xaf', '\xb1', '\x22', '\xf0', '\x77', '\x85', '\x00', '\x0d', '\xff', '\x00', '\x08', '\xbe', '\x8e', '\xf1', '\xf4', '\xdc', '\x2c', '\x62', '\xff', '\x00', '\xe2', '\x69', '\x47', '\x83', '\xfc', '\x22', '\xf1', '\xb8', '\x1e', '\x19', '\xd1', '\x4b', '\xe4', '\x7c', '\xa2', '\xc6', '\x2c', '\xff', '\x00', '\x2a', '\x39', '\x82', '\xc7', '\xc7', '\x54', '\x57', '\xd7', '\x77', '\x3e', '\x0b', '\xf0', '\xbd', '\xb4', '\x65', '\xdf', '\xc3', '\x5a', '\x54', '\x84', '\xb7', '\x04', '\x58', '\xc6', '\xa0', '\x0c', '\x7b', '\x2d', '\x5a', '\xb5', '\xf0', '\x47', '\x85', '\x64', '\x8f', '\x2f', '\xe1', '\xbd', '\x18', '\xf0', '\x31', '\xfe', '\x83', '\x17', '\xa6', '\x7d', '\x3d', '\xe9', '\x73', '\xf4', '\x1d', '\x8f', '\x8e', '\xa8', '\xaf', '\xb0', '\xcf', '\x81', '\xfc', '\x2c', '\xcf', '\xb6', '\x2f', '\x0f', '\xe8', '\xa0', '\xa1', '\x3b', '\x83', '\x58', '\x44', '\x7f', '\xf6', '\x5a', '\x59', '\xbc', '\x15', '\xe1', '\xa4', '\x28', '\x13', '\xc3', '\x3a', '\x1f', '\xbe', '\x6c', '\x23', '\xe0', '\x7f', '\xdf', '\x34', '\xf9', '\x85', '\x63', '\xe3', '\xba', '\x2b', '\xec', '\x86', '\xf0', '\x5f', '\x85', '\xb6', '\xe7', '\xfe', '\x11', '\x7d', '\x13', '\xdf', '\xfd', '\x02', '\x2e', '\x3f', '\xf1', '\xda', '\x62', '\xf8', '\x17', '\xc2', '\x6a', '\x46', '\xdf', '\x0e', '\x69', '\x0d', '\x9e', '\xe6', '\xca', '\x33', '\xff', '\x00', '\xb2', '\xd1', '\xcc', '\x16', '\x3e', '\x3a', '\xa2', '\xbe', '\xc3', '\x7f', '\x05', '\xf8', '\x5e', '\x47', '\x30', '\xc7', '\xe1', '\x8d', '\x1c', '\x1c', '\x7d', '\xf1', '\x63', '\x0f', '\x07', '\xfe', '\xf9', '\xaa', '\xd7', '\x3e', '\x0a', '\xf0', '\xcb', '\x36', '\xef', '\xf8', '\x47', '\x74', '\x95', '\x18', '\xfb', '\xa9', '\xa7', '\xc4', '\x09', '\x1e', '\xbd', '\x29', '\x39', '\xdb', '\xa1', '\x37', '\x3a', '\xe4', '\x9a', '\x33', '\xc1', '\x74', '\xe9', '\xd3', '\x70', '\xcf', '\xe5', '\x50', '\xb5', '\xd4', '\x51', '\x6f', '\xde', '\x70', '\xb9', '\x38', '\x27', '\x1c', '\xd0', '\xb3', '\xa3', '\xb9', '\x8b', '\x04', '\xb6', '\x33', '\x92', '\xbc', '\x62', '\xa1', '\xbc', '\x82', '\x3d', '\xa3', '\x20', '\x0f', '\xf6', '\xb0', '\x00', '\xc7', '\x6f', '\xa5', '\x4b', '\x34', '\x18', '\x97', '\x0c', '\x6d', '\xda', '\x52', '\x8c', '\x13', '\x27', '\x04', '\x2e', '\x78', '\xab', '\x51', '\x23', '\xc8', '\x44', '\xf8', '\x5c', '\xe3', '\x0a', '\x08', '\x23', '\x00', '\xd5', '\x68', '\x9f', '\xf7', '\x66', '\x24', '\x21', '\xcb', '\x8e', '\x99', '\x07', '\x1f', '\xe3', '\x56', '\x04', '\xc5', '\xa3', '\xc2', '\x37', '\xce', '\x07', '\x5d', '\xa4', '\x73', '\xe9', '\x40', '\x36', '\x28', '\x63', '\x9d', '\x92', '\x21', '\x0b', '\x8c', '\x12', '\x71', '\x83', '\x9a', '\x8b', '\x6f', '\xd9', '\xee', '\x0e', '\xc0', '\x17', '\x70', '\xf9', '\x9c', '\x8e', '\x1b', '\xff', '\x00'}
		raw_image = append(raw_image, []byte{'\xaf', '\x4f', '\x05', '\x9d', '\x79', '\x76', '\x5f', '\x52', '\x0e', '\x01', '\xff', '\x00', '\x0a', '\xaf', '\x71', '\x14', '\x9f', '\x24', '\xb1', '\xca', '\x0c', '\x67', '\xe6', '\x20', '\xf4', '\x03', '\xd4', '\x0a', '\x02', '\x25', '\xd6', '\x90', '\x86', '\x2b', '\xe5', '\x97', '\x2a', '\x31', '\x95', '\xc6', '\x0d', '\x23', '\x12', '\x24', '\x0c', '\x49', '\x5e', '\x84', '\x82', '\xbc', '\xe4', '\xff', '\x00', '\x9f', '\xd2', '\xa2', '\x4b', '\x84', '\x8c', '\x2a', '\x0c', '\xb6', '\xef', '\xba', '\x14', '\x63', '\x38', '\x3d', '\xaa', '\x5d', '\x88', '\x5d', '\x64', '\x60', '\x77', '\x9e', '\x73', '\xde', '\x80', '\xb0', '\xc9', '\x1f', '\xe4', '\x25', '\x7e', '\x40', '\x31', '\x92', '\xe3', '\x8f', '\xc3', '\x15', '\x22', '\x05', '\x20', '\x03', '\x80', '\xc7', '\xa6', '\x38', '\x15', '\x5e', '\xe3', '\x7b', '\x38', '\x50', '\x38', '\x27', '\x69', '\xc8', '\xe9', '\xcd', '\x3d', '\x51', '\x22', '\xf3', '\x19', '\x81', '\x03', '\xa6', '\x73', '\xb7', '\x3f', '\xad', '\x17', '\xb0', '\x98', '\xc9', '\x5e', '\x54', '\x24', '\xc6', '\xa3', '\x20', '\xf5', '\x2a', '\x4f', '\xe5', '\x55', '\xee', '\x64', '\x08', '\xbf', '\x39', '\x1b', '\x9c', '\x63', '\x1b', '\xba', '\x0f', '\x4a', '\xb2', '\xb7', '\x02', '\x29', '\xbc', '\xa0', '\x92', '\x63', '\x8c', '\x1c', '\xe7', '\x3c', '\xd3', '\x6f', '\xa5', '\xf2', '\x07', '\xdd', '\xc6', '\xf3', '\x80', '\x41', '\x1c', '\xd4', '\xe8', '\x66', '\xd2', '\xb1', '\x3a', '\x05', '\x84', '\xee', '\x0c', '\xcc', '\xac', '\x00', '\x24', '\x9c', '\xe3', '\xde', '\xaa', '\x4c', '\xcd', '\x34', '\x8e', '\xb8', '\x03', '\x03', '\x80', '\xaf', '\x8a', '\xb2', '\x92', '\x19', '\x63', '\x68', '\x80', '\x91', '\x71', '\x9e', '\x76', '\xf5', '\xa8', '\x0a', '\x46', '\x58', '\xb6', '\x4f', '\x9a', '\x0f', '\x24', '\xb6', '\x37', '\x7d', '\x69', '\xb3', '\x40', '\x66', '\x11', '\xb2', '\x26', '\x4a', '\x90', '\x47', '\xca', '\xa7', '\x26', '\x91', '\x99', '\xa2', '\x99', '\x88', '\x52', '\x55', '\xb9', '\x39', '\x3d', '\x3f', '\x3a', '\x8a', '\x59', '\xcc', '\x6e', '\xc0', '\x80', '\xec', '\xfc', '\x05', '\x52', '\x38', '\xa5', '\x68', '\xcc', '\xd1', '\x86', '\x25', '\x83', '\x63', '\x76', '\x09', '\x1c', '\xfa', '\xd0', '\xc2', '\x7a', '\x16', '\x3c', '\xd4', '\x0e', '\x50', '\x9e', '\x4e', '\x31', '\xef', '\x40', '\x74', '\x91', '\xd4', '\xf9', '\xaa', '\xa5', '\x79', '\xe1', '\x46', '\x47', '\xe7', '\x51', '\xb4', '\x6e', '\xfb', '\x36', '\xb9', '\xc7', '\x00', '\x82', '\x78', '\x3f', '\x5a', '\xa7', '\x7d', '\xa8', '\xc5', '\x63', '\x96', '\x75', '\x01', '\xcf', '\x2d', '\x8c', '\x91', '\x8c', '\xe7', '\x9e', '\x28', '\xb8', '\x45', '\x5d', '\xe8', '\x5f', '\x76', '\x68', '\x1b', '\xcc', '\x25', '\x76', '\xe4', '\x1f', '\x9d', '\x89', '\xcf', '\xd2', '\xa5', '\x59', '\x03', '\x33', '\x49', '\x87', '\x08', '\x46', '\x41', '\xe8', '\xb8', '\xae', '\x6e', '\x2f', '\x15', '\x09', '\xa6', '\x6f', '\xb1', '\x5a', '\x3d', '\xdc', '\xac', '\x33', '\xf2', '\x4a', '\x0a', '\x81', '\xf5', '\x3d', '\x2b', '\x48', '\x49', '\x2c', '\xaa', '\x97', '\x0e', '\x1a', '\x3e', '\xe5', '\x5b', '\x81', '\x9e', '\xfe', '\xbc', '\xd0', '\xa4', '\x9e', '\xc6', '\x8e', '\x0d', '\x6e', '\x59', '\x26', '\x69', '\x56', '\x4e', '\x46', '\xec', '\xf4', '\x42', '\x47', '\xe7', '\x56', '\x21', '\x29', '\x24', '\x7b', '\x8b', '\x79', '\x83', '\x18', '\xc9', '\xac', '\x81', '\x21', '\x8e', '\x53', '\x8e', '\x43', '\xf5', '\xe0', '\xb0', '\x23', '\xeb', '\x8a', '\x97', '\xcc', '\x36', '\xd7', '\x19', '\x8c', '\x1d', '\x87', '\x96', '\x43', '\xd2', '\x9a', '\x57', '\x76', '\x46', '\x72', '\x76', '\x57', '\x66', '\x94', '\x72', '\xab', '\xb1', '\x05', '\xd1', '\x9d', '\x78', '\x18', '\x1d', '\x28', '\xbc', '\x8d', '\x65', '\x8c', '\x6f', '\x1b', '\x8a', '\xb6', '\x54', '\x56', '\x6c', '\xd7', '\x72', '\xcd', '\x91', '\xbb', '\x6a', '\x9f', '\xe1', '\x15', '\x08', '\x63', '\x82', '\x0e', '\x48', '\x3d', '\x79', '\xab', '\xf6', '\x6e', '\xc6', '\x2e', '\xac', '\x76', '\x36', '\x51', '\xc2', '\xc6', '\xbb', '\x49', '\x60', '\x17', '\x3b', '\xb3', '\xc9', '\xfc', '\x31', '\x55', '\x27', '\x67', '\x12', '\x86', '\x47', '\x5d', '\xa7', '\xef', '\x11', '\x8c', '\x8f', '\x5a', '\xb7', '\x2b', '\x44', '\xa6', '\x35', '\x55', '\x06', '\x43', '\x85', '\x18', '\x23', '\x22', '\x90', '\x06', '\x45', '\x54', '\x16', '\xe3', '\x81', '\xc0', '\x42', '\x0e', '\x6a', '\x0d', '\xd1', '\x52', '\x4d', '\xc9', '\xbc', '\xb9', '\x56', '\xdd', '\xd1', '\xb8', '\x2d', '\xf8', '\x62', '\x98', '\xd2', '\x0b', '\x75', '\x59', '\x37', '\xe1', '\x18', '\xe3', '\xe6', '\x39', '\xfd', '\x00', '\xa9', '\x1a', '\x4c', '\x09', '\x36', '\x45', '\xb1', '\x89', '\xdb', '\xf3', '\x01', '\x83', '\x8f', '\x5c', '\x54', '\x06', '\x57', '\x96', '\xdd', '\xa3', '\xfd', '\xd0', '\x76', '\xcb', '\x74', '\xc8', '\x53', '\xda', '\xa5', '\x83', '\x57', '\x45', '\x2b', '\xdd', '\x5e', '\xde', '\xda', '\x23', '\x24', '\xed', '\x21', '\x44', '\x1b', '\xf1', '\x9d', '\xa3', '\xaf', '\xae', '\x33', '\x5c', '\xb3', '\xd9', '\x6b', '\xba', '\xfd', '\xeb', '\x11', '\x3c', '\x56', '\xf6', '\x24', '\x93', '\xf2', '\x8e', '\x1c', '\x7d', '\x3b', '\xfd', '\x6b', '\x7e', '\x2d', '\x36', '\x71', '\x79', '\xe7', '\xde', '\x36', '\x51', '\x5b', '\x08', '\x0a', '\x02', '\xa3', '\xd0', '\xd7', '\x41', '\x0d', '\x9c', '\x2d', '\x97', '\x70', '\x66', '\x6e', '\x81', '\xb7', '\x67', '\xf1', '\x19', '\xac', '\xd4', '\x65', '\x3d', '\xf6', '\x0a', '\x72', '\x6b', '\x56', '\x63', '\xe8', '\x9a', '\x5d', '\xb6', '\x89', '\x09', '\x82', '\x08', '\xc2', '\xb3', '\xe0', '\xf9', '\x83', '\x92', '\xc3', '\xd6', '\xb5', '\x11', '\x4a', '\xdc', '\x30', '\x29', '\x2b', '\x2e', '\x4b', '\x28', '\xdc', '\x08', '\xfa', '\xfb', '\xf5', '\xab', '\x02', '\x44', '\xb6', '\x11', '\x19', '\x33', '\xbb', '\xee', '\x60', '\x95', '\x18', '\x1f', '\x87', '\x6a', '\x6c', '\x2c', '\x45', '\xcb', '\xc2', '\x9c', '\xa9', '\x5f', '\x97', '\x70', '\xc6', '\x05', '\x6a', '\x92', '\x5a', '\x14', '\xdb', '\x7a', '\x91', '\xcb', '\x6a', '\x24', '\x47', '\x98', '\x97', '\x01', '\x3a', '\x03', '\xd5', '\x7d', '\x7f', '\x0a', '\xcf', '\xe7', '\xd7', '\x35', '\xa5', '\xa8', '\x49', '\xe5', '\x22', '\x46', '\x8f', '\x8c', '\x8e', '\x40', '\x1c', '\x56', '\x75', '\x6f', '\x4d', '\x59', '\x1c', '\x95', '\xe4', '\x9b', '\x42', '\x73', '\x9e', '\x28', '\xe7', '\xff', '\x00', '\xd5', '\x40', '\xe9', '\x9a', '\x5e', '\xd5', '\xa1', '\x89', '\xbe', '\x8a', '\xac', '\x9b', '\x8c', '\x7b', '\x47', '\x40', '\x08', '\xe6', '\xa3', '\x92', '\x20', '\x37', '\x31', '\xdd', '\x9e', '\x3a', '\x31', '\xfd', '\x29', '\xe2', '\x34', '\x8d', '\x72', '\x15', '\x54', '\x9e', '\x33', '\xba', '\xa3', '\x28', '\xe2', '\x61', '\x36', '\xe3', '\xb4', '\x0e', '\x87', '\x1f', '\x9d', '\x72', '\x9d', '\xc4', '\x29', '\x06', '\xe1', '\xe5', '\x89', '\x25', '\xc1', '\x1f', '\xc5', '\xc0', '\xcf', '\xb8', '\x35', '\x54', '\xc7', '\x24', '\x01', '\xd4', '\x39', '\xd8', '\xff', '\x00', '\xed', '\x0c', '\xfa', '\x7a', '\x74', '\xad', '\x29', '\x55', '\xda', '\x54', '\x7f', '\x29', '\x1d', '\x80', '\x38', '\xf9', '\xb1', '\x51', '\xb6', '\xf6', '\x8d', '\x44', '\x8a', '\xa1', '\xf7', '\x13', '\x9e', '\xa3', '\xfc', '\xf3', '\x43', '\x43', '\xe6', '\xb2', '\x16', '\x10', '\xf0', '\x04', '\x86', '\x51', '\xdb', '\xef', '\xe7', '\x8c', '\x53', '\xae', '\xf7', '\xb2', '\x2c', '\x71', '\xe5', '\x79', '\x07', '\x76', '\x71', '\x8f', '\xa7', '\x35', '\x1a', '\xa9', '\x8c', '\xba', '\x29', '\x08', '\xac', '\x39', '\xe3', '\xa7', '\xbd', '\x1c', '\xec', '\xcc', '\xc8', '\x1f', '\x8e', '\x5c', '\xf0', '\x71', '\x41', '\x29', '\xa2', '\x3f', '\x97', '\xcd', '\x6c', '\x26', '\xe2', '\x0f', '\xde', '\x23', '\xbf', '\xd4', '\xd3', '\x8c', '\x70', '\x89', '\x63', '\x92', '\x60', '\xa1', '\xf3', '\x8c', '\x81', '\xed', '\xef', '\x4a', '\xca', '\xe4', '\x3a', '\x47', '\x85', '\x55', '\x03', '\x6b', '\x1f', '\xe2', '\xa2', '\x56', '\xf2', '\xe2', '\x57', '\x95', '\xc6', '\x41', '\x04', '\x10', '\x3b', '\xd0', '\x84', '\xa4', '\xee', '\x36', '\xf9', '\x1d', '\x63', '\x3b', '\x41', '\x65', '\x61', '\xd4', '\x90', '\x71', '\xf4', '\xac', '\xba', '\x9e', '\xf2', '\x53', '\x2c', '\xdc', '\xbe', '\xf5', '\xea', '\x07', '\xa5', '\x41', '\x83'}...)
		raw_image = append(raw_image, []byte{'\x8c', '\xf6', '\xad', '\xe0', '\xac', '\x8c', '\x2a', '\xcb', '\x99', '\x88', '\x3a', '\x52', '\xd2', '\x1e', '\x39', '\xa5', '\xab', '\x32', '\x36', '\x9a', '\x19', '\x58', '\xee', '\x79', '\x17', '\x6a', '\xfd', '\xd5', '\xdb', '\xd2', '\xa3', '\xfb', '\x53', '\x96', '\x11', '\xca', '\xca', '\xbe', '\xea', '\x79', '\xc7', '\xa7', '\x35', '\x5d', '\x25', '\x31', '\xb0', '\x40', '\xb2', '\x22', '\xff', '\x00', '\x7c', '\x77', '\xfa', '\xfb', '\x54', '\xab', '\x06', '\x25', '\x2e', '\x58', '\x39', '\x6e', '\xb9', '\xea', '\x6b', '\x92', '\xf7', '\xd5', '\x1d', '\x57', '\xbe', '\xc5', '\x86', '\x54', '\xe8', '\xc4', '\xb3', '\x28', '\x07', '\x21', '\x8f', '\x4f', '\xc2', '\xa1', '\x96', '\x30', '\xce', '\x16', '\xe6', '\x40', '\xde', '\x9c', '\x95', '\x07', '\xf5', '\xa7', '\x2b', '\x84', '\xe4', '\xa9', '\x66', '\x42', '\x14', '\x95', '\x50', '\x32', '\x3f', '\xfd', '\x54', '\xf0', '\xc8', '\x32', '\x27', '\x95', '\x07', '\x1c', '\x03', '\x85', '\x22', '\x9e', '\xe5', '\xb5', '\x74', '\x31', '\x11', '\x21', '\x50', '\xa8', '\x33', '\xed', '\xd7', '\x22', '\x9e', '\xcc', '\x8b', '\x19', '\x12', '\x10', '\x14', '\x0c', '\x1c', '\xd2', '\x26', '\x3f', '\x86', '\x58', '\xc8', '\x27', '\xb1', '\xc9', '\xa0', '\x96', '\x27', '\xe5', '\x29', '\xe9', '\xd7', '\xb5', '\x04', '\x11', '\xac', '\x7b', '\x54', '\x95', '\x2e', '\xb8', '\xe0', '\x81', '\xd3', '\xf0', '\x18', '\xa6', '\x48', '\x47', '\x97', '\xf2', '\xca', '\x7a', '\x9f', '\x99', '\x97', '\xb7', '\xe3', '\xde', '\xa6', '\x56', '\x60', '\x0e', '\xdc', '\x12', '\x5b', '\xee', '\x93', '\x8a', '\x89', '\xdf', '\x30', '\x29', '\xda', '\xa7', '\x0d', '\xce', '\x0f', '\xdd', '\x1d', '\xe8', '\x2a', '\x26', '\x72', '\x40', '\xcd', '\x92', '\x09', '\xe1', '\x80', '\x1f', '\x2f', '\x5f', '\x7a', '\xb1', '\x73', '\x10', '\x57', '\x55', '\x45', '\x2a', '\x0a', '\xfc', '\xa0', '\x9c', '\x13', '\x83', '\xd4', '\x83', '\x49', '\x24', '\xc8', '\xb3', '\x2c', '\x6a', '\xc6', '\x45', '\x03', '\x24', '\x0f', '\x5f', '\x5a', '\xbc', '\x00', '\x32', '\xee', '\x73', '\xd1', '\x79', '\x04', '\xe7', '\xfc', '\xf7', '\xa6', '\xa6', '\xee', '\x45', '\x96', '\xa8', '\xc8', '\xa4', '\x1d', '\xc5', '\x3e', '\x5c', '\x09', '\x5b', '\x03', '\x0b', '\x9e', '\x3d', '\xea', '\x37', '\x60', '\xa3', '\x27', '\xe9', '\xc5', '\x74', '\x27', '\x75', '\x73', '\x9d', '\xab', '\x3b', '\x1f', '\xff', '\xd9'}...)
		writeImage(device, 1, raw_image)
		writeImage(device, 26, raw_image)
		writeImage(device, 3, raw_image)
	*/

	/*
		play, err := ioutil.ReadFile("play.jpg")
		writeImage(device, 0, play)
	*/

	/*
		red := getImageAsJpeg(writeColor(255, 0, 0))
		green := getImageAsJpeg(writeColor(0, 255, 0))
		blue := getImageAsJpeg(writeColor(0, 0, 255))
		yellow := getImageAsJpeg(writeColor(255, 255, 0))
		cyan := getImageAsJpeg(writeColor(0, 200, 255))
		purple := getImageAsJpeg(writeColor(255, 0, 255))
		white := getImageAsJpeg(writeColor(255, 255, 255))

		writeImage(device, 0, red)
		writeImage(device, 1, green)
		writeImage(device, 2, blue)
		writeImage(device, 3, yellow)
		writeImage(device, 4, cyan)
		writeImage(device, 5, purple)
		writeImage(device, 6, white)
	*/

	time.Sleep(200 * time.Second)

	device.Close()
}

// Based on set_key_image from https://github.com/abcminiuser/python-elgato-streamdeck/blob/master/src/StreamDeck/Devices/StreamDeckXL.py#L151
func writeImage(device *hid.Device, key int, raw_image []byte) {
	page_number := 0
	bytes_remaining := len(raw_image)

	IMAGE_REPORT_LENGTH := 1024
	IMAGE_REPORT_HEADER_LENGTH := 8
	IMAGE_REPORT_PAYLOAD_LENGTH := IMAGE_REPORT_LENGTH - IMAGE_REPORT_HEADER_LENGTH

	payloads := make([][]byte, 3)

	for bytes_remaining > 0 {
		this_length := 0
		if IMAGE_REPORT_PAYLOAD_LENGTH < bytes_remaining {
			this_length = IMAGE_REPORT_PAYLOAD_LENGTH
		} else {
			this_length = bytes_remaining
		}
		bytes_sent := page_number * IMAGE_REPORT_PAYLOAD_LENGTH
		header := []byte{'\x02', '\x07', byte(key)}
		if this_length == bytes_remaining {
			header = append(header, '\x01')
		} else {
			header = append(header, '\x00')
		}

		header = append(header, byte(this_length&0xff))
		header = append(header, byte(this_length>>8))

		header = append(header, byte(page_number&0xff))
		header = append(header, byte(page_number>>8))

		payload := append(header, raw_image[bytes_sent:(bytes_sent+this_length)]...)
		padding := make([]byte, IMAGE_REPORT_LENGTH-len(payload))

		thingToSend := append(payload, padding...)
		device.Write(thingToSend)
		payloads[page_number] = thingToSend

		bytes_remaining = bytes_remaining - this_length
		page_number = page_number + 1
	}
}

func writeBlankImage(device *hid.Device, key int) {
	key_b := byte(key)
	p1 := []byte{'\x02', '\x07', key_b, '\x00', '\xf8', '\x03', '\x00', '\x00', '\xff', '\xd8', '\xff', '\xe0', '\x00', '\x10', '\x4a', '\x46', '\x49', '\x46', '\x00', '\x01', '\x01', '\x00', '\x00', '\x01', '\x00', '\x01', '\x00', '\x00', '\xff', '\xdb', '\x00', '\x43', '\x00', '\x08', '\x06', '\x06', '\x07', '\x06', '\x05', '\x08', '\x07', '\x07', '\x07', '\x09', '\x09', '\x08', '\x0a', '\x0c', '\x14', '\x0d', '\x0c', '\x0b', '\x0b', '\x0c', '\x19', '\x12', '\x13', '\x0f', '\x14', '\x1d', '\x1a', '\x1f', '\x1e', '\x1d', '\x1a', '\x1c', '\x1c', '\x20', '\x24', '\x2e', '\x27', '\x20', '\x22', '\x2c', '\x23', '\x1c', '\x1c', '\x28', '\x37', '\x29', '\x2c', '\x30', '\x31', '\x34', '\x34', '\x34', '\x1f', '\x27', '\x39', '\x3d', '\x38', '\x32', '\x3c', '\x2e', '\x33', '\x34', '\x32', '\xff', '\xdb', '\x00', '\x43', '\x01', '\x09', '\x09', '\x09', '\x0c', '\x0b', '\x0c', '\x18', '\x0d', '\x0d', '\x18', '\x32', '\x21', '\x1c', '\x21', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\x32', '\xff', '\xc0', '\x00', '\x11', '\x08', '\x00', '\x60', '\x00', '\x60', '\x03', '\x01', '\x22', '\x00', '\x02', '\x11', '\x01', '\x03', '\x11', '\x01', '\xff', '\xc4', '\x00', '\x1f', '\x00', '\x00', '\x01', '\x05', '\x01', '\x01', '\x01', '\x01', '\x01', '\x01', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x01', '\x02', '\x03', '\x04', '\x05', '\x06', '\x07', '\x08', '\x09', '\x0a', '\x0b', '\xff', '\xc4', '\x00', '\xb5', '\x10', '\x00', '\x02', '\x01', '\x03', '\x03', '\x02', '\x04', '\x03', '\x05', '\x05', '\x04', '\x04', '\x00', '\x00', '\x01', '\x7d', '\x01', '\x02', '\x03', '\x00', '\x04', '\x11', '\x05', '\x12', '\x21', '\x31', '\x41', '\x06', '\x13', '\x51', '\x61', '\x07', '\x22', '\x71', '\x14', '\x32', '\x81', '\x91', '\xa1', '\x08', '\x23', '\x42', '\xb1', '\xc1', '\x15', '\x52', '\xd1', '\xf0', '\x24', '\x33', '\x62', '\x72', '\x82', '\x09', '\x0a', '\x16', '\x17', '\x18', '\x19', '\x1a', '\x25', '\x26', '\x27', '\x28', '\x29', '\x2a', '\x34', '\x35', '\x36', '\x37', '\x38', '\x39', '\x3a', '\x43', '\x44', '\x45', '\x46', '\x47', '\x48', '\x49', '\x4a', '\x53', '\x54', '\x55', '\x56', '\x57', '\x58', '\x59', '\x5a', '\x63', '\x64', '\x65', '\x66', '\x67', '\x68', '\x69', '\x6a', '\x73', '\x74', '\x75', '\x76', '\x77', '\x78', '\x79', '\x7a', '\x83', '\x84', '\x85', '\x86', '\x87', '\x88', '\x89', '\x8a', '\x92', '\x93', '\x94', '\x95', '\x96', '\x97', '\x98', '\x99', '\x9a', '\xa2', '\xa3', '\xa4', '\xa5', '\xa6', '\xa7', '\xa8', '\xa9', '\xaa', '\xb2', '\xb3', '\xb4', '\xb5', '\xb6', '\xb7', '\xb8', '\xb9', '\xba', '\xc2', '\xc3', '\xc4', '\xc5', '\xc6', '\xc7', '\xc8', '\xc9', '\xca', '\xd2', '\xd3', '\xd4', '\xd5', '\xd6', '\xd7', '\xd8', '\xd9', '\xda', '\xe1', '\xe2', '\xe3', '\xe4', '\xe5', '\xe6', '\xe7', '\xe8', '\xe9', '\xea', '\xf1', '\xf2', '\xf3', '\xf4', '\xf5', '\xf6', '\xf7', '\xf8', '\xf9', '\xfa', '\xff', '\xc4', '\x00', '\x1f', '\x01', '\x00', '\x03', '\x01', '\x01', '\x01', '\x01', '\x01', '\x01', '\x01', '\x01', '\x01', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x01', '\x02', '\x03', '\x04', '\x05', '\x06', '\x07', '\x08', '\x09', '\x0a', '\x0b', '\xff', '\xc4', '\x00', '\xb5', '\x11', '\x00', '\x02', '\x01', '\x02', '\x04', '\x04', '\x03', '\x04', '\x07', '\x05', '\x04', '\x04', '\x00', '\x01', '\x02', '\x77', '\x00', '\x01', '\x02', '\x03', '\x11', '\x04', '\x05', '\x21', '\x31', '\x06', '\x12', '\x41', '\x51', '\x07', '\x61', '\x71', '\x13', '\x22', '\x32', '\x81', '\x08', '\x14', '\x42', '\x91', '\xa1', '\xb1', '\xc1', '\x09', '\x23', '\x33', '\x52', '\xf0', '\x15', '\x62', '\x72', '\xd1', '\x0a', '\x16', '\x24', '\x34', '\xe1', '\x25', '\xf1', '\x17', '\x18', '\x19', '\x1a', '\x26', '\x27', '\x28', '\x29', '\x2a', '\x35', '\x36', '\x37', '\x38', '\x39', '\x3a', '\x43', '\x44', '\x45', '\x46', '\x47', '\x48', '\x49', '\x4a', '\x53', '\x54', '\x55', '\x56', '\x57', '\x58', '\x59', '\x5a', '\x63', '\x64', '\x65', '\x66', '\x67', '\x68', '\x69', '\x6a', '\x73', '\x74', '\x75', '\x76', '\x77', '\x78', '\x79', '\x7a', '\x82', '\x83', '\x84', '\x85', '\x86', '\x87', '\x88', '\x89', '\x8a', '\x92', '\x93', '\x94', '\x95', '\x96', '\x97', '\x98', '\x99', '\x9a', '\xa2', '\xa3', '\xa4', '\xa5', '\xa6', '\xa7', '\xa8', '\xa9', '\xaa', '\xb2', '\xb3', '\xb4', '\xb5', '\xb6', '\xb7', '\xb8', '\xb9', '\xba', '\xc2', '\xc3', '\xc4', '\xc5', '\xc6', '\xc7', '\xc8', '\xc9', '\xca', '\xd2', '\xd3', '\xd4', '\xd5', '\xd6', '\xd7', '\xd8', '\xd9', '\xda', '\xe2', '\xe3', '\xe4', '\xe5', '\xe6', '\xe7', '\xe8', '\xe9', '\xea', '\xf2', '\xf3', '\xf4', '\xf5', '\xf6', '\xf7', '\xf8', '\xf9', '\xfa', '\xff', '\xda', '\x00', '\x0c', '\x03', '\x01', '\x00', '\x02', '\x11', '\x03', '\x11', '\x00', '\x3f', '\x00', '\xf9', '\xfe', '\x8a', '\xfb', '\x1d', '\x7c', '\x17', '\xe1', '\x0b', '\x74', '\x08', '\xfe', '\x1a', '\xd2', '\x18', '\xfa', '\x9d', '\x3e', '\x32', '\x7f', '\x45', '\xa8', '\xe5', '\xf0', '\x67', '\x84', '\xcc', '\x8b', '\x29', '\xf0', '\xde', '\x8c', '\x90', '\xe3', '\x03', '\xfd', '\x02', '\x30', '\x73', '\xea', '\x78', '\xa9', '\xe6', '\x1d', '\x8f', '\x8f', '\x28', '\xaf', '\xb1', '\x22', '\xf0', '\x77', '\x85', '\x00', '\x0d', '\xff', '\x00', '\x08', '\xbe', '\x8e', '\xf1', '\xf4', '\xdc', '\x2c', '\x62', '\xff', '\x00', '\xe2', '\x69', '\x47', '\x83', '\xfc', '\x22', '\xf1', '\xb8', '\x1e', '\x19', '\xd1', '\x4b', '\xe4', '\x7c', '\xa2', '\xc6', '\x2c', '\xff', '\x00', '\x2a', '\x39', '\x82', '\xc7', '\xc7', '\x54', '\x57', '\xd7', '\x77', '\x3e', '\x0b', '\xf0', '\xbd', '\xb4', '\x65', '\xdf', '\xc3', '\x5a', '\x54', '\x84', '\xb7', '\x04', '\x58', '\xc6', '\xa0', '\x0c', '\x7b', '\x2d', '\x5a', '\xb5', '\xf0', '\x47', '\x85', '\x64', '\x8f', '\x2f', '\xe1', '\xbd', '\x18', '\xf0', '\x31', '\xfe', '\x83', '\x17', '\xa6', '\x7d', '\x3d', '\xe9', '\x73', '\xf4', '\x1d', '\x8f', '\x8e', '\xa8', '\xaf', '\xb0', '\xcf', '\x81', '\xfc', '\x2c', '\xcf', '\xb6', '\x2f', '\x0f', '\xe8', '\xa0', '\xa1', '\x3b', '\x83', '\x58', '\x44', '\x7f', '\xf6', '\x5a', '\x59', '\xbc', '\x15', '\xe1', '\xa4', '\x28', '\x13', '\xc3', '\x3a', '\x1f', '\xbe', '\x6c', '\x23', '\xe0', '\x7f', '\xdf', '\x34', '\xf9', '\x85', '\x63', '\xe3', '\xba', '\x2b', '\xec', '\x86', '\xf0', '\x5f', '\x85', '\xb6', '\xe7', '\xfe', '\x11', '\x7d', '\x13', '\xdf', '\xfd', '\x02', '\x2e', '\x3f', '\xf1', '\xda', '\x62', '\xf8', '\x17', '\xc2', '\x6a', '\x46', '\xdf', '\x0e', '\x69', '\x0d', '\x9e', '\xe6', '\xca', '\x33', '\xff', '\x00', '\xb2', '\xd1', '\xcc', '\x16', '\x3e', '\x3a', '\xa2', '\xbe', '\xc3', '\x7f', '\x05', '\xf8', '\x5e', '\x47', '\x30', '\xc7', '\xe1', '\x8d', '\x1c', '\x1c', '\x7d', '\xf1', '\x63', '\x0f', '\x07', '\xfe', '\xf9', '\xaa', '\xd7', '\x3e', '\x0a', '\xf0', '\xcb', '\x36', '\xef', '\xf8', '\x47', '\x74', '\x95', '\x18', '\xfb', '\xa9', '\xa7', '\xc4', '\x09', '\x1e', '\xbd', '\x29', '\x39', '\xdb', '\xa1', '\x37', '\x3a', '\xe4', '\x9a', '\x33', '\xc1', '\x74', '\xe9', '\xd3', '\x70', '\xcf', '\xe5', '\x50', '\xb5', '\xd4', '\x51', '\x6f', '\xde', '\x70', '\xb9', '\x38', '\x27', '\x1c', '\xd0', '\xb3', '\xa3', '\xb9', '\x8b', '\x04', '\xb6', '\x33', '\x92', '\xbc', '\x62', '\xa1', '\xbc', '\x82', '\x3d', '\xa3', '\x20', '\x0f', '\xf6', '\xb0', '\x00', '\xc7', '\x6f', '\xa5', '\x4b', '\x34', '\x18', '\x97', '\x0c', '\x6d', '\xda', '\x52', '\x8c', '\x13', '\x27', '\x04', '\x2e', '\x78', '\xab', '\x51', '\x23', '\xc8', '\x44', '\xf8', '\x5c', '\xe3', '\x0a', '\x08', '\x23', '\x00', '\xd5', '\x68', '\x9f', '\xf7', '\x66', '\x24', '\x21', '\xcb', '\x8e', '\x99', '\x07', '\x1f', '\xe3', '\x56', '\x04', '\xc5', '\xa3', '\xc2', '\x37', '\xce', '\x07', '\x5d', '\xa4', '\x73', '\xe9', '\x40', '\x36', '\x28', '\x63', '\x9d', '\x92', '\x21', '\x0b', '\x8c', '\x12', '\x71', '\x83', '\x9a', '\x8b', '\x6f', '\xd9', '\xee', '\x0e', '\xc0', '\x17', '\x70', '\xf9', '\x9c', '\x8e', '\x1b', '\xff', '\x00'}
	p2 := []byte{'\x02', '\x07', key_b, '\x00', '\xf8', '\x03', '\x01', '\x00', '\xaf', '\x4f', '\x05', '\x9d', '\x79', '\x76', '\x5f', '\x52', '\x0e', '\x01', '\xff', '\x00', '\x0a', '\xaf', '\x71', '\x14', '\x9f', '\x24', '\xb1', '\xca', '\x0c', '\x67', '\xe6', '\x20', '\xf4', '\x03', '\xd4', '\x0a', '\x02', '\x25', '\xd6', '\x90', '\x86', '\x2b', '\xe5', '\x97', '\x2a', '\x31', '\x95', '\xc6', '\x0d', '\x23', '\x12', '\x24', '\x0c', '\x49', '\x5e', '\x84', '\x82', '\xbc', '\xe4', '\xff', '\x00', '\x9f', '\xd2', '\xa2', '\x4b', '\x84', '\x8c', '\x2a', '\x0c', '\xb6', '\xef', '\xba', '\x14', '\x63', '\x38', '\x3d', '\xaa', '\x5d', '\x88', '\x5d', '\x64', '\x60', '\x77', '\x9e', '\x73', '\xde', '\x80', '\xb0', '\xc9', '\x1f', '\xe4', '\x25', '\x7e', '\x40', '\x31', '\x92', '\xe3', '\x8f', '\xc3', '\x15', '\x22', '\x05', '\x20', '\x03', '\x80', '\xc7', '\xa6', '\x38', '\x15', '\x5e', '\xe3', '\x7b', '\x38', '\x50', '\x38', '\x27', '\x69', '\xc8', '\xe9', '\xcd', '\x3d', '\x51', '\x22', '\xf3', '\x19', '\x81', '\x03', '\xa6', '\x73', '\xb7', '\x3f', '\xad', '\x17', '\xb0', '\x98', '\xc9', '\x5e', '\x54', '\x24', '\xc6', '\xa3', '\x20', '\xf5', '\x2a', '\x4f', '\xe5', '\x55', '\xee', '\x64', '\x08', '\xbf', '\x39', '\x1b', '\x9c', '\x63', '\x1b', '\xba', '\x0f', '\x4a', '\xb2', '\xb7', '\x02', '\x29', '\xbc', '\xa0', '\x92', '\x63', '\x8c', '\x1c', '\xe7', '\x3c', '\xd3', '\x6f', '\xa5', '\xf2', '\x07', '\xdd', '\xc6', '\xf3', '\x80', '\x41', '\x1c', '\xd4', '\xe8', '\x66', '\xd2', '\xb1', '\x3a', '\x05', '\x84', '\xee', '\x0c', '\xcc', '\xac', '\x00', '\x24', '\x9c', '\xe3', '\xde', '\xaa', '\x4c', '\xcd', '\x34', '\x8e', '\xb8', '\x03', '\x03', '\x80', '\xaf', '\x8a', '\xb2', '\x92', '\x19', '\x63', '\x68', '\x80', '\x91', '\x71', '\x9e', '\x76', '\xf5', '\xa8', '\x0a', '\x46', '\x58', '\xb6', '\x4f', '\x9a', '\x0f', '\x24', '\xb6', '\x37', '\x7d', '\x69', '\xb3', '\x40', '\x66', '\x11', '\xb2', '\x26', '\x4a', '\x90', '\x47', '\xca', '\xa7', '\x26', '\x91', '\x99', '\xa2', '\x99', '\x88', '\x52', '\x55', '\xb9', '\x39', '\x3d', '\x3f', '\x3a', '\x8a', '\x59', '\xcc', '\x6e', '\xc0', '\x80', '\xec', '\xfc', '\x05', '\x52', '\x38', '\xa5', '\x68', '\xcc', '\xd1', '\x86', '\x25', '\x83', '\x63', '\x76', '\x09', '\x1c', '\xfa', '\xd0', '\xc2', '\x7a', '\x16', '\x3c', '\xd4', '\x0e', '\x50', '\x9e', '\x4e', '\x31', '\xef', '\x40', '\x74', '\x91', '\xd4', '\xf9', '\xaa', '\xa5', '\x79', '\xe1', '\x46', '\x47', '\xe7', '\x51', '\xb4', '\x6e', '\xfb', '\x36', '\xb9', '\xc7', '\x00', '\x82', '\x78', '\x3f', '\x5a', '\xa7', '\x7d', '\xa8', '\xc5', '\x63', '\x96', '\x75', '\x01', '\xcf', '\x2d', '\x8c', '\x91', '\x8c', '\xe7', '\x9e', '\x28', '\xb8', '\x45', '\x5d', '\xe8', '\x5f', '\x76', '\x68', '\x1b', '\xcc', '\x25', '\x76', '\xe4', '\x1f', '\x9d', '\x89', '\xcf', '\xd2', '\xa5', '\x59', '\x03', '\x33', '\x49', '\x87', '\x08', '\x46', '\x41', '\xe8', '\xb8', '\xae', '\x6e', '\x2f', '\x15', '\x09', '\xa6', '\x6f', '\xb1', '\x5a', '\x3d', '\xdc', '\xac', '\x33', '\xf2', '\x4a', '\x0a', '\x81', '\xf5', '\x3d', '\x2b', '\x48', '\x49', '\x2c', '\xaa', '\x97', '\x0e', '\x1a', '\x3e', '\xe5', '\x5b', '\x81', '\x9e', '\xfe', '\xbc', '\xd0', '\xa4', '\x9e', '\xc6', '\x8e', '\x0d', '\x6e', '\x59', '\x26', '\x69', '\x56', '\x4e', '\x46', '\xec', '\xf4', '\x42', '\x47', '\xe7', '\x56', '\x21', '\x29', '\x24', '\x7b', '\x8b', '\x79', '\x83', '\x18', '\xc9', '\xac', '\x81', '\x21', '\x8e', '\x53', '\x8e', '\x43', '\xf5', '\xe0', '\xb0', '\x23', '\xeb', '\x8a', '\x97', '\xcc', '\x36', '\xd7', '\x19', '\x8c', '\x1d', '\x87', '\x96', '\x43', '\xd2', '\x9a', '\x57', '\x76', '\x46', '\x72', '\x76', '\x57', '\x66', '\x94', '\x72', '\xab', '\xb1', '\x05', '\xd1', '\x9d', '\x78', '\x18', '\x1d', '\x28', '\xbc', '\x8d', '\x65', '\x8c', '\x6f', '\x1b', '\x8a', '\xb6', '\x54', '\x56', '\x6c', '\xd7', '\x72', '\xcd', '\x91', '\xbb', '\x6a', '\x9f', '\xe1', '\x15', '\x08', '\x63', '\x82', '\x0e', '\x48', '\x3d', '\x79', '\xab', '\xf6', '\x6e', '\xc6', '\x2e', '\xac', '\x76', '\x36', '\x51', '\xc2', '\xc6', '\xbb', '\x49', '\x60', '\x17', '\x3b', '\xb3', '\xc9', '\xfc', '\x31', '\x55', '\x27', '\x67', '\x12', '\x86', '\x47', '\x5d', '\xa7', '\xef', '\x11', '\x8c', '\x8f', '\x5a', '\xb7', '\x2b', '\x44', '\xa6', '\x35', '\x55', '\x06', '\x43', '\x85', '\x18', '\x23', '\x22', '\x90', '\x06', '\x45', '\x54', '\x16', '\xe3', '\x81', '\xc0', '\x42', '\x0e', '\x6a', '\x0d', '\xd1', '\x52', '\x4d', '\xc9', '\xbc', '\xb9', '\x56', '\xdd', '\xd1', '\xb8', '\x2d', '\xf8', '\x62', '\x98', '\xd2', '\x0b', '\x75', '\x59', '\x37', '\xe1', '\x18', '\xe3', '\xe6', '\x39', '\xfd', '\x00', '\xa9', '\x1a', '\x4c', '\x09', '\x36', '\x45', '\xb1', '\x89', '\xdb', '\xf3', '\x01', '\x83', '\x8f', '\x5c', '\x54', '\x06', '\x57', '\x96', '\xdd', '\xa3', '\xfd', '\xd0', '\x76', '\xcb', '\x74', '\xc8', '\x53', '\xda', '\xa5', '\x83', '\x57', '\x45', '\x2b', '\xdd', '\x5e', '\xde', '\xda', '\x23', '\x24', '\xed', '\x21', '\x44', '\x1b', '\xf1', '\x9d', '\xa3', '\xaf', '\xae', '\x33', '\x5c', '\xb3', '\xd9', '\x6b', '\xba', '\xfd', '\xeb', '\x11', '\x3c', '\x56', '\xf6', '\x24', '\x93', '\xf2', '\x8e', '\x1c', '\x7d', '\x3b', '\xfd', '\x6b', '\x7e', '\x2d', '\x36', '\x71', '\x79', '\xe7', '\xde', '\x36', '\x51', '\x5b', '\x08', '\x0a', '\x02', '\xa3', '\xd0', '\xd7', '\x41', '\x0d', '\x9c', '\x2d', '\x97', '\x70', '\x66', '\x6e', '\x81', '\xb7', '\x67', '\xf1', '\x19', '\xac', '\xd4', '\x65', '\x3d', '\xf6', '\x0a', '\x72', '\x6b', '\x56', '\x63', '\xe8', '\x9a', '\x5d', '\xb6', '\x89', '\x09', '\x82', '\x08', '\xc2', '\xb3', '\xe0', '\xf9', '\x83', '\x92', '\xc3', '\xd6', '\xb5', '\x11', '\x4a', '\xdc', '\x30', '\x29', '\x2b', '\x2e', '\x4b', '\x28', '\xdc', '\x08', '\xfa', '\xfb', '\xf5', '\xab', '\x02', '\x44', '\xb6', '\x11', '\x19', '\x33', '\xbb', '\xee', '\x60', '\x95', '\x18', '\x1f', '\x87', '\x6a', '\x6c', '\x2c', '\x45', '\xcb', '\xc2', '\x9c', '\xa9', '\x5f', '\x97', '\x70', '\xc6', '\x05', '\x6a', '\x92', '\x5a', '\x14', '\xdb', '\x7a', '\x91', '\xcb', '\x6a', '\x24', '\x47', '\x98', '\x97', '\x01', '\x3a', '\x03', '\xd5', '\x7d', '\x7f', '\x0a', '\xcf', '\xe7', '\xd7', '\x35', '\xa5', '\xa8', '\x49', '\xe5', '\x22', '\x46', '\x8f', '\x8c', '\x8e', '\x40', '\x1c', '\x56', '\x75', '\x6f', '\x4d', '\x59', '\x1c', '\x95', '\xe4', '\x9b', '\x42', '\x73', '\x9e', '\x28', '\xe7', '\xff', '\x00', '\xd5', '\x40', '\xe9', '\x9a', '\x5e', '\xd5', '\xa1', '\x89', '\xbe', '\x8a', '\xac', '\x9b', '\x8c', '\x7b', '\x47', '\x40', '\x08', '\xe6', '\xa3', '\x92', '\x20', '\x37', '\x31', '\xdd', '\x9e', '\x3a', '\x31', '\xfd', '\x29', '\xe2', '\x34', '\x8d', '\x72', '\x15', '\x54', '\x9e', '\x33', '\xba', '\xa3', '\x28', '\xe2', '\x61', '\x36', '\xe3', '\xb4', '\x0e', '\x87', '\x1f', '\x9d', '\x72', '\x9d', '\xc4', '\x29', '\x06', '\xe1', '\xe5', '\x89', '\x25', '\xc1', '\x1f', '\xc5', '\xc0', '\xcf', '\xb8', '\x35', '\x54', '\xc7', '\x24', '\x01', '\xd4', '\x39', '\xd8', '\xff', '\x00', '\xed', '\x0c', '\xfa', '\x7a', '\x74', '\xad', '\x29', '\x55', '\xda', '\x54', '\x7f', '\x29', '\x1d', '\x80', '\x38', '\xf9', '\xb1', '\x51', '\xb6', '\xf6', '\x8d', '\x44', '\x8a', '\xa1', '\xf7', '\x13', '\x9e', '\xa3', '\xfc', '\xf3', '\x43', '\x43', '\xe6', '\xb2', '\x16', '\x10', '\xf0', '\x04', '\x86', '\x51', '\xdb', '\xef', '\xe7', '\x8c', '\x53', '\xae', '\xf7', '\xb2', '\x2c', '\x71', '\xe5', '\x79', '\x07', '\x76', '\x71', '\x8f', '\xa7', '\x35', '\x1a', '\xa9', '\x8c', '\xba', '\x29', '\x08', '\xac', '\x39', '\xe3', '\xa7', '\xbd', '\x1c', '\xec', '\xcc', '\xc8', '\x1f', '\x8e', '\x5c', '\xf0', '\x71', '\x41', '\x29', '\xa2', '\x3f', '\x97', '\xcd', '\x6c', '\x26', '\xe2', '\x0f', '\xde', '\x23', '\xbf', '\xd4', '\xd3', '\x8c', '\x70', '\x89', '\x63', '\x92', '\x60', '\xa1', '\xf3', '\x8c', '\x81', '\xed', '\xef', '\x4a', '\xca', '\xe4', '\x3a', '\x47', '\x85', '\x55', '\x03', '\x6b', '\x1f', '\xe2', '\xa2', '\x56', '\xf2', '\xe2', '\x57', '\x95', '\xc6', '\x41', '\x04', '\x10', '\x3b', '\xd0', '\x84', '\xa4', '\xee', '\x36', '\xf9', '\x1d', '\x63', '\x3b', '\x41', '\x65', '\x61', '\xd4', '\x90', '\x71', '\xf4', '\xac', '\xba', '\x9e', '\xf2', '\x53', '\x2c', '\xdc', '\xbe', '\xf5', '\xea', '\x07', '\xa5', '\x41', '\x83'}
	p3 := []byte{'\x02', '\x07', key_b, '\x01', '\x27', '\x01', '\x02', '\x00', '\x8c', '\xf6', '\xad', '\xe0', '\xac', '\x8c', '\x2a', '\xcb', '\x99', '\x88', '\x3a', '\x52', '\xd2', '\x1e', '\x39', '\xa5', '\xab', '\x32', '\x36', '\x9a', '\x19', '\x58', '\xee', '\x79', '\x17', '\x6a', '\xfd', '\xd5', '\xdb', '\xd2', '\xa3', '\xfb', '\x53', '\x96', '\x11', '\xca', '\xca', '\xbe', '\xea', '\x79', '\xc7', '\xa7', '\x35', '\x5d', '\x25', '\x31', '\xb0', '\x40', '\xb2', '\x22', '\xff', '\x00', '\x7c', '\x77', '\xfa', '\xfb', '\x54', '\xab', '\x06', '\x25', '\x2e', '\x58', '\x39', '\x6e', '\xb9', '\xea', '\x6b', '\x92', '\xf7', '\xd5', '\x1d', '\x57', '\xbe', '\xc5', '\x86', '\x54', '\xe8', '\xc4', '\xb3', '\x28', '\x07', '\x21', '\x8f', '\x4f', '\xc2', '\xa1', '\x96', '\x30', '\xce', '\x16', '\xe6', '\x40', '\xde', '\x9c', '\x95', '\x07', '\xf5', '\xa7', '\x2b', '\x84', '\xe4', '\xa9', '\x66', '\x42', '\x14', '\x95', '\x50', '\x32', '\x3f', '\xfd', '\x54', '\xf0', '\xc8', '\x32', '\x27', '\x95', '\x07', '\x1c', '\x03', '\x85', '\x22', '\x9e', '\xe5', '\xb5', '\x74', '\x31', '\x11', '\x21', '\x50', '\xa8', '\x33', '\xed', '\xd7', '\x22', '\x9e', '\xcc', '\x8b', '\x19', '\x12', '\x10', '\x14', '\x0c', '\x1c', '\xd2', '\x26', '\x3f', '\x86', '\x58', '\xc8', '\x27', '\xb1', '\xc9', '\xa0', '\x96', '\x27', '\xe5', '\x29', '\xe9', '\xd7', '\xb5', '\x04', '\x11', '\xac', '\x7b', '\x54', '\x95', '\x2e', '\xb8', '\xe0', '\x81', '\xd3', '\xf0', '\x18', '\xa6', '\x48', '\x47', '\x97', '\xf2', '\xca', '\x7a', '\x9f', '\x99', '\x97', '\xb7', '\xe3', '\xde', '\xa6', '\x56', '\x60', '\x0e', '\xdc', '\x12', '\x5b', '\xee', '\x93', '\x8a', '\x89', '\xdf', '\x30', '\x29', '\xda', '\xa7', '\x0d', '\xce', '\x0f', '\xdd', '\x1d', '\xe8', '\x2a', '\x26', '\x72', '\x40', '\xcd', '\x92', '\x09', '\xe1', '\x80', '\x1f', '\x2f', '\x5f', '\x7a', '\xb1', '\x73', '\x10', '\x57', '\x55', '\x45', '\x2a', '\x0a', '\xfc', '\xa0', '\x9c', '\x13', '\x83', '\xd4', '\x83', '\x49', '\x24', '\xc8', '\xb3', '\x2c', '\x6a', '\xc6', '\x45', '\x03', '\x24', '\x0f', '\x5f', '\x5a', '\xbc', '\x00', '\x32', '\xee', '\x73', '\xd1', '\x79', '\x04', '\xe7', '\xfc', '\xf7', '\xa6', '\xa6', '\xee', '\x45', '\x96', '\xa8', '\xc8', '\xa4', '\x1d', '\xc5', '\x3e', '\x5c', '\x09', '\x5b', '\x03', '\x0b', '\x9e', '\x3d', '\xea', '\x37', '\x60', '\xa3', '\x27', '\xe9', '\xc5', '\x74', '\x27', '\x75', '\x73', '\x9d', '\xab', '\x3b', '\x1f', '\xff', '\xd9', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00', '\x00'}
	device.Write(p1)
	device.Write(p2)
	device.Write(p3)
}

func writeColor(red uint8, green uint8, blue uint8) *image.RGBA {
	ButtonSize := 96
	img := image.NewRGBA(image.Rect(0, 0, ButtonSize, ButtonSize))

	color := color.RGBA{red, green, blue, 0}
	draw.Draw(img, img.Bounds(), image.NewUniform(color), image.Point{0, 0}, draw.Src)

	return img
}

func getImageAsJpeg(img image.Image) []byte {
	var b bytes.Buffer
	jpeg.Encode(&b, img, nil)
	return b.Bytes()
}

func reset(device *hid.Device) {
	payload := []byte{'\x03', '\x02'}
	device.SendFeatureReport(payload)
}

func read(device *hid.Device) {
	for {
		data := make([]byte, 50)
		_, err := device.Read(data)
		if err != nil {
			fmt.Println(err)
			continue
		}
		for i := 0; i < 32; i++ {
			if data[4+i] == 1 {
				writePlayAt(device, 32-i)
			}
		}
		fmt.Println(data)
	}
}

func writePlayAt(device *hid.Device, key int) {
	f, err := os.Open("play.jpg")
	if err != nil {
		panic(err)
	}
	img, err := jpeg.Decode(f)
	if err != nil {
		panic(err)
	}
	img = resizeAndRotate(img, 96, 96)
	writeImage(device, key, getImageAsJpeg(img))

}

// resize returns a resized copy of the supplied image with the given width and height.
func resizeAndRotate(img image.Image, width, height int) image.Image {
	g := gift.New(
		gift.Resize(width, height, gift.LanczosResampling),
		gift.UnsharpMask(1, 1, 0),
		gift.Rotate180(),
	)
	res := image.NewRGBA(g.Bounds(img.Bounds()))
	g.Draw(res, img)
	return res
}
